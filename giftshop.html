<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Charles Benjamin - Souvenir Gift Shop</title>
    <link rel="shortcut icon" type="image/png" href="https://a.imge.to/2019/06/29/gD8YY.png">
    <style>
        body {
            font-family: "Baskerville", serif;
            font-style: italic;
            /* Changed background to white as requested */
            background-color: #ffffff;
            font-size: clamp(0.9rem, 2vw, 1.15rem);
            z-index: 1001;
            color: #000;
            margin: 10px;
        }
        /* Navigation (Shared) */
        .nav-row {
            text-align: right;
            padding-right: 10px;
            margin-bottom: 20px;
        }
        /* Grid Container */
        .shop-grid {
            position: relative;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            /* Height will be set via JS based on absolute positioning */
        }
        /* Product Item */
        .product-item {
            position: absolute;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            background-color: #ffffff;
            /* Smooth transitions for moving and scaling */
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1),
                width 0.4s cubic-bezier(0.25, 0.8, 0.25, 1),
                height 0.4s cubic-bezier(0.25, 0.8, 0.25, 1),
                opacity 0.4s;
            transform-origin: center center;
            overflow: hidden;
            /* Keep image inside boundaries while squishing */
            /* Default padding */
            padding: 5px;
            z-index: 1;
        }
        .product-item.active {
            z-index: 20;
        }
        .product-item.neighbor {
            z-index: 10;
        }
        .product-img {
            width: 100%;
            height: calc(100% - 90px);
            /* Strictly constrain height to leave room for text + margin */
            object-fit: contain;
            /* Maintain natural aspect ratio without distorting */
            display: block;
            /* prevent phantom spacing under image */
        }
        .shop-info {
            font-family: "Baskerville", serif;
            font-style: italic;
            text-align: center;
            margin-top: 10px;
            /* Fixed height for info area */
            height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            flex-shrink: 0;
            width: 100%;
            /* transition opacity to hide text of squeezed items for cleaner look */
            transition: opacity 0.3s;
        }
        .product-item.squeezed .shop-info {
            opacity: 1;
            /* User requested they don't disappear */
        }
        .shop-desc {
            margin: 0 0 5px 0;
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
        }
        .shop-price-row {
            margin: 0 0 5px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
        }
        .shop-price {
            font-weight: normal;
        }
        .shop-sold {
            color: red;
            font-weight: bold;
            display: none;
        }
        .shop-sold.visible {
            display: inline;
        }
        .request-btn {
            display: inline-block;
            text-decoration: underline;
            color: black;
            cursor: pointer;
            font-size: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }
        .request-btn:hover {
            text-decoration: none;
        }
    </style>
</head>
<body bgcolor="FFFFFF" text="grey" link="#000000" vlink="#000000" alink="#000000">
    <!-- Navigation -->
    <div class="nav-row">
        <i>
            <a style="text-decoration: none; color:black; font-style: italic;" href="index.html"
                target="_self">Exhibitions</a>&nbsp;&nbsp;
            <a style="text-decoration: none; color:black;" href="work" target="_self"
                target="blank">Works</a>&nbsp;&nbsp;
            <a style="text-decoration: underline; color:black;" href="giftshop" target="_self"
                target="blank">Giftshop</a>&nbsp;&nbsp;
            &nbsp;&nbsp;<a style="text-decoration: none; color:black;" href="text"
                target="_self">Texts/publication</a>&nbsp;&nbsp;
            <a style=" text-decoration: none; color:black;" href="contact" target="_self"><span
                    style="color:black">Contact</span></a>
            &nbsp;&nbsp;<a style="text-decoration: none; color:black;" href="http:\\www.mariokreuzberg.com"
                target="_self">Mario Kreuzberg</a>&nbsp;&nbsp;
            &nbsp;&nbsp;<a style="text-decoration: none; color:black;" href="http:\\hellenkeller.work"
                target="_self">Hellen Keller</a>&nbsp;&nbsp;
        </i>
    </div>
    <!-- Main Shop Viewer -->
    <div id="shop-container"></div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Provided product data
            const products = [
                { id: 1, src: "https://i.imgur.com/KS229RO.jpg", desc: "Felt Handcuffs", price: "12 CHF", sold: true },
                { id: 2, src: "https://i.imgur.com/KeIS06t.jpg", desc: "Gingham Skirt", price: "90 CHF", sold: true },
                { id: 3, src: "https://i.imgur.com/Rs5hCEI.jpg", desc: "Orangina", price: "50 CHF", sold: true },
                { id: 4, src: "https://i.imgur.com/vP2CDVA.jpg", desc: "Epicuro", price: "50 CHF", sold: true },
                { id: 6, src: "https://i.imgur.com/E6GGko4.jpg", desc: "Peroni", price: "50 CHF", sold: true },
                { id: 8, src: "https://i.imgur.com/FTnKk0A.jpg", desc: "Augustiner", price: "50 CHF", sold: true },
                { id: 9, src: "https://i.imgur.com/FNwTZgL.jpg", desc: "Red Stripe", price: "50 CHF", sold: true },
                { id: 10, src: "https://i.imgur.com/mgymcSo.jpg", desc: "Champange Benjamin", price: "50 CHF", sold: true },
                { id: 11, src: "https://i.imgur.com/UWOQjsY.jpg", desc: "Heineken", price: "50 CHF", sold: true },
                { id: 12, src: "https://i.imgur.com/zlKuVri.jpg", desc: "Paulaner", price: "50 CHF", sold: true },
                { id: 13, src: "https://i.imgur.com/MJD8fTl.jpg", desc: "Club Mate", price: "50 CHF", sold: true },
                { id: 14, src: "https://i.imgur.com/heKH3Zo.jpg", desc: "La España Vacia", price: "50 CHF", sold: false },
                { id: 15, src: "https://i.imgur.com/IVt04tb.jpg", desc: "Yoga Model(1)", price: "22 CHF", sold: true },
                { id: 16, src: "https://i.imgur.com/h4wLOLD.jpg", desc: "YOGA T", price: "25 CHF", sold: false },
                { id: 17, src: "https://i.imgur.com/5CZKkqy.jpg", desc: "Yoga Model(2)", price: "22 CHF", sold: false },
                { id: 18, src: "https://i.imgur.com/wq7WPKj.jpg", desc: "Yoga Model(3)", price: "22 CHF", sold: false },
                { id: 19, src: "https://i.imgur.com/KODeWZu.jpg", desc: "Yoga Model(4)", price: "22 CHF", sold: true },
                { id: 20, src: "https://i.imgur.com/FCSshj2.jpg", desc: "Yoga Model(5)", price: "22 CHF", sold: false },
                { id: 21, src: "https://i.imgur.com/yilKfOJ.jpg", desc: "Coyote foot by Cassidy Toner", price: "150 CHF", sold: true },
                { id: 22, src: "https://i.imgur.com/xulEG8m.jpg", desc: "Slippers I(s43)", price: "34 CHF", sold: false },
                { id: 23, src: "https://i.imgur.com/rK6MvpQ.jpg", desc: "Slippers II(s43)", price: "24 CHF", sold: false },
                { id: 24, src: "https://i.imgur.com/6yVrGHm.jpg", desc: "Desperation Bag", price: "25 CHF", sold: false },
                { id: 25, src: "https://i.imgur.com/CvIVqm0.jpg", desc: "Ceramic Fish", price: "12 CHF", sold: true },
                { id: 26, src: "https://i.imgur.com/SbfsLME.jpg", desc: "Candelabra I", price: "18 CHF", sold: true },
                { id: 27, src: "https://i.imgur.com/Qf9rNi3.jpg", desc: "Very Tired Che Guevara", price: "4 CHF", sold: true },
                { id: 28, src: "https://i.imgur.com/3gIO7X3.jpg", desc: "Dolphine(made in china)", price: "19 CHF", sold: true },
                { id: 29, src: "https://i.imgur.com/KucD2wP.jpg", desc: "Donostia Vacía", price: "25 CHF", sold: true },
                { id: 30, src: "https://i.imgur.com/XsX3GqA.jpg", desc: "Palau Vacía", price: "25 CHF", sold: false },
                { id: 31, src: "https://i.imgur.com/GrDTUh8.jpg", desc: "Kissing Elephants", price: "250 CHF", sold: false },
                { id: 32, src: "https://i.imgur.com/9JJrJTq.jpg", desc: "Skinny Homer Simpson", price: "150 CHF", sold: true },
                { id: 33, src: "https://i.imgur.com/3LJFdKR.jpg", desc: "Cats", price: "11 CHF", sold: true },
                { id: 34, src: "https://i.imgur.com/7Pmslb4.jpg", desc: "Lettuce by Victor Delestre", price: "1000 CHF", sold: true },
                { id: 35, src: "https://i.imgur.com/M1bJwkm.jpg", desc: "Item 17 Description", price: "200 CHF", sold: false },
                { id: 36, src: "https://i.imgur.com/ArEDSRq.jpg", desc: "Item 18 Description", price: "120 CHF", sold: false },
                { id: 37, src: "https://i.imgur.com/oDJi9Gu.jpg", desc: "Item 19 Description", price: "80 CHF", sold: false },
                { id: 38, src: "https://i.imgur.com/719MzQZ.jpg", desc: "Item 20 Description", price: "300 CHF", sold: true },
                { id: 39, src: "https://i.imgur.com/vZjxxIm.jpg", desc: "Item 21 Description", price: "90 CHF", sold: false },
                { id: 40, src: "https://i.imgur.com/4JKdn0A.jpg", desc: "Item 22 Description", price: "110 CHF", sold: false },
                { id: 41, src: "https://i.imgur.com/rK6MvpQ.jpg", desc: "Item 23 Description", price: "50 CHF", sold: false },
                { id: 42, src: "https://i.imgur.com/6yVrGHm.jpg", desc: "Item 24 Description", price: "500 CHF", sold: true },
                { id: 43, src: "https://i.imgur.com/CvIVqm0.jpg", desc: "Item 25 Description", price: "250 CHF", sold: false },
                { id: 44, src: "https://i.imgur.com/SbfsLME.jpg", desc: "Item 26 Description", price: "180 CHF", sold: false },
                { id: 45, src: "https://i.imgur.com/Qf9rNi3.jpg", desc: "Item 27 Description", price: "130 CHF", sold: false },
                { id: 46, src: "https://i.imgur.com/3gIO7X3.jpg", desc: "Item 28 Description", price: "160 CHF", sold: false },
                { id: 47, src: "https://i.imgur.com/daqjm35.jpg", desc: "Item 29 Description", price: "60 CHF", sold: false },
                { id: 48, src: "https://i.imgur.com/aHYYsiD.jpg", desc: "Item 30 Description", price: "75 CHF", sold: false },
                { id: 49, src: "https://i.imgur.com/STSstJ9.jpg", desc: "Item 31 Description", price: "220 CHF", sold: true },
                { id: 50, src: "https://i.imgur.com/9GcxuRK.jpg", desc: "Item 32 Description", price: "95 CHF", sold: false },
                { id: 51, src: "https://i.imgur.com/F82O0a3.jpg", desc: "Item 33 Description", price: "140 CHF", sold: false },
                { id: 52, src: "https://i.imgur.com/YlBM5b4.jpg", desc: "Item 34 Description", price: "1000 CHF", sold: true },
            ];
            const grid = document.getElementById('shop-container');
            const itemElements = [];
            // Layout constants
            const GAP = 60; // More spacious
            const BASE_HEIGHT = 200; // Smaller before enlargement
            const SCALE_MULT = 2.0;
            function getColumns() {
                // Max 4 per row
                if (window.innerWidth >= 900) return 4;
                if (window.innerWidth >= 600) return 3;
                return 2;
            }
            let currentCols = getColumns();
            let baseWidth = 0;
            let containerWidth = 0;
            let activeIdx = -1; // Track which item is clicked
            // Populate DOM once
            function renderDOM() {
                grid.innerHTML = '';
                grid.className = 'shop-grid';
                itemElements.length = 0;
                products.forEach((product, idx) => {
                    const item = document.createElement('div');
                    item.className = 'product-item';
                    item.dataset.index = idx;
                    const img = document.createElement('img');
                    img.src = product.src;
                    img.alt = product.desc;
                    img.className = 'product-img';
                    const info = document.createElement('div');
                    info.className = 'shop-info';
                    const desc = document.createElement('div');
                    desc.className = 'shop-desc';
                    desc.textContent = product.desc;
                    const priceRow = document.createElement('div');
                    priceRow.className = 'shop-price-row';
                    const price = document.createElement('span');
                    price.className = 'shop-price';
                    price.textContent = product.price;
                    priceRow.appendChild(price);
                    const sold = document.createElement('span');
                    sold.className = 'shop-sold';
                    sold.textContent = 'SOLD';
                    if (product.sold) sold.classList.add('visible');
                    priceRow.appendChild(sold);
                    const btn = document.createElement('a');
                    btn.className = 'request-btn';
                    btn.textContent = product.sold ? "Send email regarding this item" : "Request this item";
                    const email = "placeholder@email.com";
                    btn.href = `mailto:${email}?subject=Request for ${product.desc}&body=Hi`;
                    info.appendChild(desc);
                    info.appendChild(priceRow);
                    info.appendChild(btn);
                    item.appendChild(img);
                    item.appendChild(info);
                    grid.appendChild(item);
                    itemElements.push(item);
                });
            }
            // Calculate precise X, Y coordinates and Width/Height for every bubble
            function calculateLayout(currentActiveIdx = -1) {
                containerWidth = grid.getBoundingClientRect().width;
                if (containerWidth === 0) return; // Hidden or not ready
                // The base grid
                const maxW = Math.min(1400, containerWidth); // from max-width in CSS
                const totalGaps = (currentCols - 1) * GAP;
                // To prevent edge items from getting cut off during a 2x expansion, 
                // the grid needs a natural padding of exactly extraW/2 on the left and right.
                // Since extraW = baseWidth (for a 2x scale), extraW/2 = baseWidth/2.
                // So Space Needed = (currentCols * baseWidth) + totalGaps + 2*(baseWidth/2).
                // Which simplifies to: Space Needed = (currentCols + 1) * baseWidth + totalGaps.
                baseWidth = (maxW - totalGaps) / (currentCols + 1);
                const safeMarginX = baseWidth / 2;
                const safeMarginY = BASE_HEIGHT / 2; // Provide safe margin for vertical expansion too
                const rowsCount = Math.ceil(products.length / currentCols);
                let hc = -1, hr = -1;
                if (currentActiveIdx !== -1) {
                    hc = currentActiveIdx % currentCols;
                    hr = Math.floor(currentActiveIdx / currentCols);
                }
                // Desired extra size requested by User (2x)
                const extraW = baseWidth * (SCALE_MULT - 1);
                const extraH = BASE_HEIGHT * (SCALE_MULT - 1);
                // For a bubble effect, the center grows +extraW. 
                // We compress ONLY the neighbors in its path to absorb that extra width/height.
                // Left neighbor loses half extraW, Right neighbor loses half extraW, etc.
                itemElements.forEach((item, idx) => {
                    const c = idx % currentCols;
                    const r = Math.floor(idx / currentCols);
                    // Base coordinates including safe border margin
                    let x = safeMarginX + c * (baseWidth + GAP);
                    let y = safeMarginY + r * (BASE_HEIGHT + GAP);
                    let w = baseWidth;
                    let h = BASE_HEIGHT;
                    let dx = 0;
                    let dy = 0;
                    let sx = 1;
                    let sy = 1;
                    // Reset Classes
                    item.className = 'product-item';
                    if (activeIdx !== -1) {
                        const dc = c - hc; // Distance in columns: -1 is left, +1 is right
                        const dr = r - hr; // Distance in rows: -1 is top, +1 is bottom
                        // IS TARGET 
                        if (dc === 0 && dr === 0) {
                            sx = SCALE_MULT;
                            sy = SCALE_MULT;
                            item.classList.add('active');
                        }
                        // IS NEIGHBOR (Distance <= 1 in both axis)
                        else if (Math.abs(dc) <= 1 && Math.abs(dr) <= 1) {
                            item.classList.add('neighbor');
                            item.classList.add('squeezed');
                            // Compute scale so visual width shrinks exactly by extraW/2
                            if (dc !== 0) {
                                sx = (w - extraW / 2) / w;
                                // Move center so bounding box aligns perfectly against target
                                dx = (dc > 0 ? 1 : -1) * (extraW / 4);
                            }
                            if (dr !== 0) {
                                sy = (h - extraH / 2) / h;
                                dy = (dr > 0 ? 1 : -1) * (extraH / 4);
                            }
                        }
                        // Outer shells don't move or scale! The math above 
                        // completely absorbs all extra space without pushing outwards.
                    }
                    // Apply Styles 
                    // To distort text visually without reflow clipping, we use scale
                    item.style.transform = `translate(${x + dx}px, ${y + dy}px) scale(${sx}, ${sy})`;
                    item.style.width = `${w}px`;
                    item.style.height = `${h}px`;
                });
                // Update Grid wrapper height
                // The size requirement is completely constant during click because the bubble shrinks neighbors rather than bloating the grid
                let totalH = rowsCount * (BASE_HEIGHT + GAP) - GAP + (safeMarginY * 2);
                grid.style.height = `${totalH}px`;
            }
            // Init
            renderDOM();
            // Allow CSS to load then calc
            setTimeout(() => calculateLayout(-1), 50);
            // Responsive updates
            window.addEventListener('resize', () => {
                const newCols = getColumns();
                if (newCols !== currentCols) {
                    currentCols = newCols;
                }
                calculateLayout(activeIdx);
            });
            // Click interactions
            activeIdx = -1;
            grid.addEventListener('click', (e) => {
                const item = e.target.closest('.product-item');
                // If they clicked the container gap, close
                if (!item) {
                    activeIdx = -1;
                    calculateLayout(activeIdx);
                    return;
                }
                // Clicking a button shouldn't collapse the layout
                if (e.target.closest('.request-btn')) return;
                const clickedIdx = parseInt(item.dataset.index);
                // Toggle
                if (activeIdx === clickedIdx) {
                    activeIdx = -1;
                } else {
                    activeIdx = clickedIdx;
                }
                calculateLayout(activeIdx);
            });
        });
    </script>
</body>
</html>
